<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Những dòng tâm sự</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #ffe6e6;
            font-family: Arial, sans-serif;
            text-align: center;
            overflow: hidden;
        }
        #illustration {
            width: 200px;
            height: auto;
            margin-bottom: 20px; /* Tạo khoảng cách với thẻ bài */
        }
        #cardContainer {
            position: relative;
            width: 300px;
            height: 400px;
            margin-bottom: 50px; /* Đưa thẻ bài lên cao hơn */
        }
        .card {
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: absolute;
            transition: transform 0.3s ease-out, z-index 0.3s;
        }
        .buttons {
            display: none;
            flex-direction: row;
            gap: 20px; /* Tạo khoảng cách giữa hai nút */
        }
        .button {
            padding: 12px 24px;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s ease-in-out;
        }
        .green {
            background-color: green;
            color: white;
        }
        .red {
            background-color: red;
            color: white;
            position: relative;
        }
    </style>
</head>
<body>
    <img id="illustration" src="https://i.imgur.com/Z6L3a1H.png" alt="Hình minh họa">
    
    <div id="cardContainer"></div>
    <div class="buttons" id="finalButtons">
        <button class="button green" onclick="nextPage()">Được rồi em sẽ xem xét</button>
        <button class="button red" id="redButton" onclick="changeRedButton()">Thôi anh nói nhiều vậy cũng không được gì đâu</button>
    </div>

    <script>
        const messages = [
            "Thôi anh nói nhiều vậy cũng không được gì đâu",
            "Nói nhiều cũng vô ích thôi ý",
            "Em không muốn yêu đương gì hết á",
            "Em đang mệt yêu",
            "Thực ra anh đang không giống với những gì em nghĩ",
            "Hmmm",
            "Thôi được rồi",
            "Vì là lần đầu tiên nên em xem xét"
        ];
        let messageIndex = 0;
        let cards = [];
        let currentIndex = 0;
        const cardContainer = document.getElementById("cardContainer");
        const redButton = document.getElementById("redButton");

        function createCards() {
            for (let i = 0; i < 10; i++) {
                const card = document.createElement("div");
                card.classList.add("card");
                card.innerText = `Nội dung thẻ ${i + 1}`;
                card.style.zIndex = 10 - i;
                card.style.transform = `translateY(${i * 5}px)`;
                cardContainer.appendChild(card);
                cards.push(card);
                addSwipeListeners(card);
            }
        }

        function addSwipeListeners(card) {
            let startX, currentX, isDragging = false;

            card.addEventListener("mousedown", (event) => {
                startX = event.clientX;
                isDragging = true;
            });

            card.addEventListener("mousemove", (event) => {
                if (!isDragging) return;
                currentX = event.clientX;
                let moveX = currentX - startX;
                card.style.transform = `translateX(${moveX}px) rotate(${moveX / 10}deg)`;
            });

            card.addEventListener("mouseup", () => handleSwipeEnd(card, currentX - startX));
            card.addEventListener("mouseleave", () => handleSwipeEnd(card, currentX - startX));

            card.addEventListener("touchstart", (event) => {
                startX = event.touches[0].clientX;
                isDragging = true;
            });

            card.addEventListener("touchmove", (event) => {
                if (!isDragging) return;
                currentX = event.touches[0].clientX;
                let moveX = currentX - startX;
                card.style.transform = `translateX(${moveX}px) rotate(${moveX / 10}deg)`;
            });

            card.addEventListener("touchend", () => handleSwipeEnd(card, currentX - startX));
        }

        function handleSwipeEnd(card, diff) {
            if (Math.abs(diff) > 100) {
                let direction = diff > 0 ? '100px' : '-100px';
                card.style.transform = `translateX(${direction}) rotate(${diff > 0 ? 20 : -20}deg)`;

                setTimeout(() => {
                    card.style.transform = `translateX(0) rotate(0) translateY(${cards.length * 5}px)`;
                    card.style.zIndex = 0; // Đưa thẻ ra sau
                    cards.push(cards.shift()); // Di chuyển thẻ đầu ra cuối
                    updateZIndex();
                    currentIndex++;
                    if (currentIndex === cards.length) {
                        document.getElementById("finalButtons").style.display = "flex";
                    }
                }, 300);
            } else {
                card.style.transform = `translateX(0) rotate(0)`;
            }
        }

        function updateZIndex() {
            cards.forEach((card, index) => {
                card.style.zIndex = 10 - index;
            });
        }

        createCards();

        function nextPage() {
            window.location.href = "final_page.html";
        }

        function changeRedButton() {
            if (messageIndex < messages.length) {
                redButton.innerText = messages[messageIndex];
                messageIndex++;
                let moveX = Math.random() * 40 - 20; // Di chuyển nhẹ trong khoảng -20px đến 20px
                let moveY = Math.random() * 40 - 20;
                redButton.style.transform = `translate(${moveX}px, ${moveY}px)`;
            } else {
                redButton.classList.remove("red");
                redButton.classList.add("green");
                redButton.innerText = "Được rồi em sẽ xem xét";
                redButton.onclick = nextPage;
            }
        }
    </script>
</body>
</html>
